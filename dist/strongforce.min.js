/**
 * @license
 * strongforce - v0.1.0
 * Copyright (c) 2014, Salvador de la Puente
 * https://github.com/lodr/strongforce
 *
 * Compiled: 2014-04-23
 *
 * strongforce is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){"use strict";var a=this,b=b||{};b.NOOP=function(){},b.IS_PRECALL=!1,b.IS_POSTCALL=!0,b.Loop=function(){function a(a){function d(){u||(e(0),h())}function e(a){g(),o=a||0,q=void 0,s=0}function g(){r=Date.now(),u=!1}function h(){u||(f(j),u=!0)}function i(a){a=a||v.simulationDelta,u||j(void 0,a)}function j(a,b){var c;if(u){f(j),p=Date.now(),void 0===q&&(q=p),c=p-q,q=p,x+=(c-x)/20;var d=Math.min(void 0!==b?b:c,v.maxSimulationTime);s+=d;for(var e=v.simulationDelta||s;s>=e;)l(w,o,e,m),n(),o+=e,s-=e;var g=s/e;k(w,g),t=Date.now()}}function k(a,b){a.traverse("render","getRenderSubmodels",[b])}function l(a,b,c,d){a.traverse("simulate","getSimulateSubmodels",[b,c,d])}function m(a){y.push(a)}function n(){for(;y.length;)y.shift()()}b(a);var o,p,q,r,s,t,u=!1,v=c(a),w=v.rootModel,x=0,y=[];return Object.defineProperty(this,"rootModel",{value:w}),{start:d,reset:e,pause:g,resume:h,step:i,get frameTime(){return x}}}function b(a){if(void 0===a.rootModel)throw new Error("The `rootModel` key is mandatory!")}function c(a){var b={};for(var c in e)e.hasOwnProperty(c)&&(b[c]=a[c]||e[c]);return b}var d=this,e={rootModel:void 0,maxSimulationTime:300,simulationDelta:10},f=d.requestAnimationFrame;return a}.call(this),b.EventEmitter=function(){function a(){Object.defineProperty(this,"_listeners",{value:{}})}return a.prototype.dispatchEvent=function(a,b){b=b||{},b.type=a,b.target=this,b.timestamp=Date.now(),this._runListeners(a,b)},a.prototype._runListeners=function(a,b){var c=this._listeners[a]||[],d=[];c.forEach(function(a){var c=a[0],e=a[1];c(b),e||d.push(a)}),this._listeners[a]=d},a.prototype.addEventListener=function(a,b,c){function d(a){return a[0]===b}var e=this._listeners,f=e[a]=e[a]||[];f.some(d)||f.push([b,c])},a.prototype.removeEventListener=function(a,b){for(var c,d=this._listeners,e=d[a]=d[a]||[],f=-1,g=0;(c=e[g])&&0>f;g++)c[0]===b&&(f=g);-1!==f&&d[a].splice(f,1)},a.prototype.removeAllEventListener=function(a){this._listeners[a]=[]},a}.call(this),b.Render=function(){function a(){}var c=b.NOOP,d=b.IS_PRECALL,e=b.IS_POSTCALL;return a.prototype.apply=function(a,b){var c=b[0],d=[a].concat(b.slice(1));this[c?"postRender":"render"].apply(this,d)},a.prototype.render=c,a.prototype.postRender=c,a.prototype.delegateToRender=function(a){var b=[d].concat(Array.prototype.slice.call(arguments,1));a.render.apply(a,b)},a.prototype.delegateToPostRender=function(a){var b=[e].concat(Array.prototype.slice.call(arguments,1));a.postRender.apply(a,b)},a}.call(this),b.Simulator=function(){function a(){}var c=b.NOOP;return a.prototype.apply=function(a,b){b=b||[];var c=b[0],d=[a].concat(b.slice(1));this[c?"postSimulate":"simulate"].apply(this,d)},a.prototype.simulate=c,a.prototype.postSimulate=c,a}.call(this),b.Model=function(a,c,d){function e(b,d){var e,f,g,h,i;i={simulate:c,render:a};for(var j in i)i.hasOwnProperty(j)&&(f=i[j],g=b[j].prototype,e=g instanceof f,e&&(h=Object.create(g),b[j].apply(h,[b].concat(d)),b[j]=h))}function f(){d.apply(this),Object.defineProperty(this,"id",{value:g++}),e(this,[].slice.call(arguments,0))}var g=1,h=b.IS_PRECALL,i=b.IS_POSTCALL,j=b.NOOP,k=d.prototype;for(var l in k)k.hasOwnProperty(l)&&(f.prototype[l]=k[l]);return f.prototype.traverse=function(a,b,c){var d,e,f=this[a],g=f&&"function"==typeof f.apply;c=[null].concat(c),g&&(c[0]=h,f.apply(this,c)),d=[],e=this[b],e&&"function"==typeof e.apply&&(d=e.apply(this)||[]);var j=arguments;d.forEach(function(a){a.traverse.apply(a,j)}),g&&(c[0]=i,f.apply(this,c))},f.prototype.simulate=j,f.prototype.getSimulateSubmodels=function(){return this.getSubmodels()},f.prototype.render=j,f.prototype.getRenderSubmodels=function(){return this.getSubmodels()},f.prototype.getSubmodels=function(){return[]},f}.call(this,b.Render,b.Simulator,b.EventEmitter),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.strongforce=b):"undefined"!=typeof define&&define.amd?define(b):a.strongforce=b}).call(this);